<!DOCTYPE html>
<html>
<head lang="en">
  <meta charset="UTF-8">
  <title>W3C Performance Examples</title>
</head>
<body>
<h1>W3C Web Performance</h1>
<p>
  <a href="./index.html">reload</a>
</p>
<input type="BUTTON" value="Click me!" onclick="clickme();">
<p id="reply">
</p>

<h2>Cached Steve</h2>
<img src="cachedSteve.jpg" prio='high'/>

<h2> Steve</h2>
<h2>How fast is Steve?</h2>
<img src="steve.jpg" prio='high'/>


</body>
<script>

  function clickme(){
    performance.mark('start');
    var xmlhttp;
    xmlhttp=new XMLHttpRequest();
    xmlhttp.onreadystatechange=function(){
      if (xmlhttp.readyState==4 && xmlhttp.status==200){
        document.getElementById("reply").innerHTML=xmlhttp.responseText;
        performance.measure('serverRequest', 'start');
      }
    }
    xmlhttp.open("GET","reply.txt",true);
    xmlhttp.send();
  }

  var top = 0;
  var resourceList = window.performance.getEntriesByType("resource");
  resourceList.sort (function (a,b){return (a.duration - b.duration) * -1});
  for (i = 0; i < resourceList.length && top < 10 ; i++){
    if (resourceList[i].initiatorType == "img") {
      ++top;
      console.log('Load time ' + resourceList[i].name  +  ' is ' + ((resourceList[i].responseEnd - resourceList[i].startTime).toFixed(2) + ' ms'));
    }
  }


</script>
</html>